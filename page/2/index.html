<!DOCTYPE html>
<html lang="zh-CN">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="谢红光" />


    
    


<meta property="og:type" content="website">
<meta property="og:title" content="茶壶盖">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="茶壶盖">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="茶壶盖">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="茶壶盖" type="application/atom+xml">



    <link rel="shortcut icon" href="/img/dog.jpg">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">


    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>茶壶盖</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/dog.jpg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">谢红光</a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="/xiehongguang0228@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="https://github.com/Alvis888" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa StackOverflow" href="https://stackoverflow.com/users/6244981/xiehongguang" title="StackOverflow"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/NET/">.NET</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/360云/">360云</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AZURE/">AZURE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Axis属性/">Axis属性</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bt/">Bt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Build-Event/">Build Event</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-写入文件/">C#写入文件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CURD/">CURD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ESLint/">ESLint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Email/">Email</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ExecuteNonQuery/">ExecuteNonQuery ()</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Json/">Json</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LUIS/">LUIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React-D3-Axis/">React-D3 Axis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL-server/">SQL server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Socket/">Socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VS/">VS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XML/">XML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bat/">bat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bot/">bot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bot-framework/">bot framework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c-c/">c/c++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/case语句/">case语句</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/date/">date()</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dialog/">dialog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fetch/">fetch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fetch链接数据库/">fetch链接数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hook/">hook</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/material-ui/">material ui</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microsoft-bot/">microsoft bot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/office/">office</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/qq/">qq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react-native/">react native</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rn/">rn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sate/">sate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/select/">select</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/server-2008/">server 2008</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/service/">service</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/slack/">slack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlserver/">sqlserver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql日期加减/">sql日期加减</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql日期格式化/">sql日期格式化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/static/">static</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/string/">string</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thinkphp/">thinkphp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/time/">time()</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-api/">web api</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webhook/">webhook</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webhook，Gitlab/">webhook，Gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows-service/">windows service</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/word/">word</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wpf/">wpf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内存管理/">内存管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/删除/">删除</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图片库/">图片库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/字符串/">字符串</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/存储过程/">存储过程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/实体形式/">实体形式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/弹窗/">弹窗</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/截取/">截取</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/搭建/">搭建</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库，AZURE/">数据库，AZURE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/时间戳/">时间戳</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/电影/">电影</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/登陆页面/">登陆页面</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/种子/">种子</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/空白页/">空白页</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网盘搜索/">网盘搜索</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网站/">网站</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/美剧/">美剧</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/选择框/">选择框</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/邮件/">邮件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/链接/">链接</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">专注于前端</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">谢红光</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/dog.jpg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">谢红光</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="/xiehongguang0228@gmail.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/Alvis888" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa StackOverflow" target="_blank" href="https://stackoverflow.com/users/6244981/xiehongguang" title="StackOverflow"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-以管理员身份运行bat文件" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/04/13/以管理员身份运行bat文件/" class="article-date">
      <time datetime="2017-04-13T02:51:30.000Z" itemprop="datePublished">2017-04-13</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/13/以管理员身份运行bat文件/">以管理员身份运行bat文件</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <div>

<pre><code>方法二
@echo off
cacls.exe &quot;%SystemDrive%\System Volume Information&quot; &amp;gt;nul 2&amp;gt;nul
if %errorlevel%==0 goto Admin
if exist &quot;%temp%\getadmin.vbs&quot; del /f /q &quot;%temp%\getadmin.vbs&quot;
echo Set RequestUAC = CreateObject^(&quot;Shell.Application&quot;^)&amp;gt;&quot;%temp%\getadmin.vbs&quot;
echo RequestUAC.ShellExecute &quot;%~s0&quot;,&quot;&quot;,&quot;&quot;,&quot;runas&quot;,1 &amp;gt;&amp;gt;&quot;%temp%\getadmin.vbs&quot;
echo WScript.Quit &amp;gt;&amp;gt;&quot;%temp%\getadmin.vbs&quot;
&quot;%temp%\getadmin.vbs&quot; /f
if exist &quot;%temp%\getadmin.vbs&quot; del /f /q &quot;%temp%\getadmin.vbs&quot;
exit

:Admin`&lt;/pre&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;

:Admin后换行跟自己的批处理；
根据实际情况修改“RequestUAC”“%temp%\getadmin.vbs”这两个字段吧。

我做了补充，
一是对于生成的vbs要做清理嘛；

二是要让Wscript执行WScript.Quit来结束进程，不然进程里会一直有脚本解释器在运行；

另外，是关于操作系统的版本这个问题：
（当然可能是自作多情）
我考虑了在低于Vista/2008的情况下，关于UAC的问题。
我有毒...
UAC并不存在于XP里，嗯。

当然我也考虑了把批处理放在低于Vista/2008操作系统里运行的情况：
若是在管理员账户（包括超级管理员）下运行，那就不需要前面这个判断UAC的了；
若是在受限账户下运行，要拿权限，我猜就需要Hack点的手段了吧，不是很懂。

所以如果需要判断操作系统的，那就把这段放最前面：

&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;
&lt;pre&gt;`@echo off
ver|findstr &quot;[6,10]\.[0-9]\.[0-9][0-9]*&quot; &amp;gt; nul &amp;amp;&amp;amp; (goto Main)
ver|findstr &quot;[3-5]\.[0-9]\.[0-9][0-9]*&quot; &amp;gt; nul &amp;amp;&amp;amp; (goto isBelowNT6)

:isBelowNT6

:Main
</code></pre><p></p></div><br><br><br>作者：刘楷杰<br>链接：<a href="https://www.zhihu.com/question/34541107/answer/137174053" target="_blank" rel="external">https://www.zhihu.com/question/34541107/answer/137174053</a><br>来源：知乎<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。<p></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/未分类/">未分类</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bat/">bat</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-C# Socket 收发数据" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/04/10/C# Socket 收发数据/" class="article-date">
      <time datetime="2017-04-10T13:29:45.000Z" itemprop="datePublished">2017-04-10</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/10/C# Socket 收发数据/">C# Socket 收发数据</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在发送数据之前，首发双方约定好统一的端口，数据起始符、结束符</p>
<p>Socket 通过单一信道进行收发数据</p>
<p>&nbsp;</p>
<div>

<pre><code>class Program
{
    static void Main(string[] args)
    {
         ServerController.Listen(8888);

        string data = &quot;我真帅&quot;;
        string result = ServerController.Send(&quot;127.0.0.1&quot;, 8888, data);
        Console.WriteLine(&quot;Send：{0}\r\nReceive：{1}&quot;, data, result);
        Console.ReadKey();
    }
}

`&lt;/pre&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;
&lt;pre&gt;`public class ServerController //: Controller
{
    /*数据的开始结束符号*/

    /// &amp;lt;summary&amp;gt;
    /// 编码 解码
    /// &amp;lt;/summary&amp;gt;
    private static Encoding encode = Encoding.Default;

    /// &amp;lt;summary&amp;gt;
    /// 监听请求
    /// &amp;lt;/summary&amp;gt;
    /// &amp;lt;param name=&quot;port&quot;&amp;gt;端口&amp;lt;/param&amp;gt;
    public static void Listen(int port)
    {

        //IPv4  双向基于连接的字节流  传输控制协议
        Socket listenSocket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        // 将Socket与本地端点相关联
        listenSocket.Bind(new IPEndPoint(IPAddress.Any, port));
        // 挂起连接队列的最大长度
        listenSocket.Listen(100);
        Console.WriteLine(&quot;Listen &quot; + port + &quot; ...&quot;);
        //循环监听
        while (true)
        {
            //未接收，则一直阻塞
            Socket acceptSocket = listenSocket.Accept();
            try
            {
                //1s timeout.
                string receiveData = Receive(acceptSocket, 1000); 
                Console.WriteLine(&quot;Receive：&quot; + receiveData);
                //发送接受状态
                Send(acceptSocket, &quot;ok&quot;);
            }
            catch (Exception e)
            {
                //发送接受状态
                Send(acceptSocket, &quot;failed&quot;);
                Console.WriteLine(e);
            }

            DestroySocket(acceptSocket); //import
        }
    }

    /// &amp;lt;summary&amp;gt;
    /// 发送数据
    /// &amp;lt;/summary&amp;gt;
    /// &amp;lt;param name=&quot;host&quot;&amp;gt;主机名 IP&amp;lt;/param&amp;gt;
    /// &amp;lt;param name=&quot;port&quot;&amp;gt;端口&amp;lt;/param&amp;gt;
    /// &amp;lt;param name=&quot;data&quot;&amp;gt;数据&amp;lt;/param&amp;gt;
    /// &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;
    public static string Send(string host, int port, string data)
    {

        string result = string.Empty;
        Socket clientSocket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        try
        {
            //建立与远程hos的连接
            clientSocket.Connect(host, port);
            ////发送数据
            //clientSocket.Send(encode.GetBytes(data));
            //发送数据data
            Send(clientSocket, data);
            //等待2秒
            result = Receive(clientSocket, 1000 * 2); //1*2 seconds timeout.
            //销毁socket
        }
        catch (Exception e)
        {
            Console.WriteLine(&quot;由于目标计算机积极拒绝，无法连接&quot; + e);
        }

        DestroySocket(clientSocket);
        //Console.WriteLine(&quot;Send：{0}\r\nReceive：{1}&quot;, data, result);

        return result;
    }

    /// &amp;lt;summary&amp;gt;
    /// 发送数据
    /// &amp;lt;/summary&amp;gt;
    /// &amp;lt;param name=&quot;socket&quot;&amp;gt;socket&amp;lt;/param&amp;gt;
    /// &amp;lt;param name=&quot;data&quot;&amp;gt;数据&amp;lt;/param&amp;gt;
    private static void Send(Socket socket, string data)
    {
        //字符编码为字节序列，然后发送
        socket.Send(encode.GetBytes(data));
    }

    /// &amp;lt;summary&amp;gt;
    /// 接收数据
    /// &amp;lt;/summary&amp;gt;
    /// &amp;lt;param name=&quot;socket&quot;&amp;gt;&amp;lt;/param&amp;gt;
    /// &amp;lt;param name=&quot;timeout&quot;&amp;gt;&amp;lt;/param&amp;gt;
    /// &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;
    public static string Receive(Socket socket, int timeout)
    {
        string result = string.Empty;
        // 超时
        socket.ReceiveTimeout = timeout;
        List&amp;lt;byte&amp;gt; data = new List&amp;lt;byte&amp;gt;();
        byte[] buffer = new byte[1024];
        try
        {
            //1.若缓冲区buffer比接收数据小，需多次Receive才能完成；
            //2.多次Receive时，每次接收字节数length大小不固定；
            //3.实际接收字节数据
            int length = 0;
            //循环接收数据到接收缓冲区
            while ((length = socket.Receive(buffer)) &amp;gt; 0)
            {
                for (int j = 0; j &amp;lt; length; j++)
                {
                    data.Add(buffer[j]);
                }
            }
        }
        catch (Exception e)
        {
            Console.WriteLine(e);
        }
        if (data.Count &amp;gt; 0)
        {
            //字节转化为字符
            result = encode.GetString(data.ToArray(), 0, data.Count);
        }

        return result;
    }

    /// &amp;lt;summary&amp;gt;
    /// 销毁Socket对象
    /// &amp;lt;/summary&amp;gt;
    /// &amp;lt;param name=&quot;socket&quot;&amp;gt;&amp;lt;/param&amp;gt;
    private static void DestroySocket(Socket socket)
    {
        try
        {
            if (socket != null)
            {
                if (socket.Connected)
                {
                    socket.Shutdown(SocketShutdown.Both);
                }
                socket.Close();
            }
            Console.WriteLine(&quot;Socket销毁成功&quot;);
        }
        catch (Exception e)
        {
            Console.WriteLine(&quot;Socket销毁失败&quot; + e);
            throw;
        }

    }
}
</code></pre><p></p></div><br><br><a href="https://msdn.microsoft.com/en-us/library/system.net.sockets.socket(v=vs.110).aspx" target="_blank" rel="external">https://msdn.microsoft.com/en-us/library/system.net.sockets.socket(v=vs.110).aspx</a><p></p>
<p><a href="https://msdn.microsoft.com/en-us/library/2b86d684(v=vs.110).aspx" target="_blank" rel="external">https://msdn.microsoft.com/en-us/library/2b86d684(v=vs.110).aspx</a></p>
<p><a href="https://msdn.microsoft.com/zh-cn/library/system.net.sockets.socket_methods(v=vs.80).aspx" target="_blank" rel="external">https://msdn.microsoft.com/zh-cn/library/system.net.sockets.socket_methods(v=vs.80).aspx</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/C/">C#</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NET/">.NET</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/">C#</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Socket/">Socket</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-net连接 mysql数据库以及 增删改查基本操作" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/25/net连接 mysql数据库以及 增删改查基本操作/" class="article-date">
      <time datetime="2017-03-25T09:56:15.000Z" itemprop="datePublished">2017-03-25</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/25/net连接 mysql数据库以及 增删改查基本操作/">.net连接 mysql数据库以及 增删改查基本操作</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>直接甩干货 控制台应用程序</p>
<pre><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data.SqlClient;
using System.Data;
using MySql.Data.MySqlClient;
namespace ConsoleApplication3
{
    class Program
    {
        private static MySqlConnection connectDataBase()
        {
            string str = &quot;Server=12*.11*.2*.*;User ID=*u*h*ng;Password=y*u*h*ng**;Database=yo*s*a*g;CharSet=utf8;convert zero datetime=True;&quot;;
            MySqlConnection conn = new MySqlConnection(str);
            return conn;
        }//end connectDataBase()

        static void Main(string[] args)
        {
            // Connect to the master database and create the sample database
            using (MySqlConnection conn = connectDataBase())
            {
                conn.Open();

                //查询
                using (MySqlCommand querySingleInfo = conn.CreateCommand())
                {
                    querySingleInfo.CommandText = &quot;select business_category from multi_config where id=1 &quot;;
                    using (MySqlDataReader reader = querySingleInfo.ExecuteReader())
                    {
                        // Loop over the results 
                        while (reader.Read())
                        {
                            Console.WriteLine(reader[&quot;business_category&quot;].ToString().Trim());
                          //  Console.ReadKey();
                        }
                    }
                }

                ///更新  添加  删除
                using (MySqlCommand myCommand = conn.CreateCommand())
                {
                    myCommand.Connection = conn;
                    myCommand.CommandText = &quot;update multi_config set service_status=-1 where id=10&quot;;
                    int ans = myCommand.ExecuteNonQuery();
                    Console.WriteLine(ans);
                    Console.ReadKey();
                }
            }

        }//end Main()

    }//end class Program

}
</code></pre><p><br>&nbsp;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/SQL/">SQL</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NET/">.NET</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-windows server 2008 安装windows服务" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/03/14/windows server 2008 安装windows服务/" class="article-date">
      <time datetime="2017-03-14T06:42:53.000Z" itemprop="datePublished">2017-03-14</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/14/windows server 2008 安装windows服务/">windows server 2008 安装windows服务</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>在 win 10 系统开发的windows service 程序，但需要应用在windows server 系统上，安装的时候提示找不到installutil.exe安装工具，导致无法安装window 服务。原因是server 系统中的.net Framework 版本太低，只是v.2。查询到以下两个较为使用的解决方案：</p>
<ol>
<li><p>nssm.exe工具    以安装nginx为例</p>
<ol>
<li><strong><span class="Apple-converted-space">下载nginx windows版本</span></strong>：<a href="http://nginx.org/" target="_blank" rel="external">http://nginx.org/</a></li>
<li><strong> 下载 nssm ：<a href="http://nssm.cc/" target="_blank" rel="external">http://nssm.cc/</a></strong></li>
<li><p><strong>安装</strong><br>Nginx下载解压到一个目录，nssm下载后解压相应版本（32/64）到一个目录。<br>然后安装服务：</p>
<div>

<p>nssm install N1 “D:\N1\nginx.exe”    `<br></p></div><br><span class="Apple-converted-space"><span class="Apple-converted-space">   </span></span><p></p>
</li>
<li><span class="Apple-converted-space"><span class="Apple-converted-space">即可安装成功最基本的服务，不过启动的是nssm，让后由nssm启动nginx。</span></span>现在就可以通过控制面板-&gt;管理员工具-&gt;服务中找到该服务，并启动和停止了。当然，net start 和 net stop也是可以的。<br>但是，当停止服务后，会发现网站仍在正常运转。查看进程会发现还有一个nginx进程存在。原来，nginx启动了两个nginx进程(根据nginx.conf的配置worker_processes  1;)，一个监控进程，一个工作进程。显然，停止的是监控进程，而工作进程没停，结果就是nginx仍在运行。因此彻底关闭nginx就需要别的手段，如任务管理器或者使用taskkill命令:<br>taskkill /F /IM nginx.exe &gt; nul<br>当然，可以写一个脚本来处理nginx停止的所有操作：<div><br><pre><code>@echo off
echo Stopping nginx service...
net stop N1
echo Kill nginx process...
taskkill /F /IM nginx.exe &amp;gt; nul</code></pre><br></div></li>
<li><span class="Apple-converted-space"><span class="Apple-converted-space">想删除服务:   </span></span><div><br><pre><code>sc delete Nginx</code></pre><br></div></li>
<li><span class="Apple-converted-space"><span class="Apple-converted-space">卸载服务:   </span></span><div><br><pre>`nssm remove nginx<br></pre></div></li>
<li><p>异常情况</p>
<pre><code>1.  &lt;pre&gt;Service not starting - Error 3&lt;/pre&gt;

        1.  原因 ：服务指向的地址为nssm的安装位置， 修改地址即可

    2.  1053

        1.  原因太多：（bug\超时\ .net Framework b版本）建议更新 .net Framework  版本
</code></pre><ol>
<li><span style="color: #ff0000;">注意：需要在注册表中通过ImagePath修改可服务执行文件的位置</span></li>
</ol>
</li>
</ol>
</li>
<li><p>更新 .net Framework</p>
<ol>
<li>下载 <a href="https://www.microsoft.com/en-us/download/details.aspx?id=53344" target="_blank" rel="external">https://www.microsoft.com/en-us/download/details.aspx?id=53344</a></li>
<li>点击 安装 按钮</li>
<li>安装成功</li>
<li>检查情况 位置 C:\Windows\Microsoft.NET\Framework v.4.0.30319<br>参考</li>
</ol>
</li>
<li><p><a href="http://stackoverflow.com/questions/25241560/windows-process-activation-service-not-starting-error-3" target="_blank" rel="external">http://stackoverflow.com/questions/25241560/windows-process-activation-service-not-starting-error-3</a></p>
</li>
<li><a href="http://www.cnblogs.com/itcomputer/p/6216038.html" target="_blank" rel="external">http://www.cnblogs.com/itcomputer/p/6216038.html</a></li>
<li><a href="http://www.cnblogs.com/ChineseMoonGod/p/5575715.html" target="_blank" rel="external">http://www.cnblogs.com/ChineseMoonGod/p/5575715.html</a></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/windows-Service/">windows Service</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/server-2008/">server 2008</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/service/">service</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-如何调试Windows Service" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/15/如何调试Windows Service/" class="article-date">
      <time datetime="2017-02-15T09:22:35.000Z" itemprop="datePublished">2017-02-15</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/15/如何调试Windows Service/">如何调试Windows Service</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>安装成功后需要手动开启服务，因为我们刚设置 serviceInstaller1.StartType 为 Manual<br>打开windows 服务管理器，找到名为 Service1 的服务，右键属性。点击【启动】按钮</p>
<p>&nbsp;</p>
<p>windows 调试<br>1 回到开发环境，选择调试-&gt;附加到进程，勾选”显示所有用户进程“<br>2 找到 WindowsService1.exe 进程（如果没有点击下刷新按钮），选中后点击“附加到进程”按钮。<br>3 选中 Service1.cs 文件，后按 F7 打开代码视图<br>4 在所有 str 变量上添加调试断点<br>5 回到windows服务管理器，找 Service1 服务并选中它，在左侧有一个“暂停”按钮。点击一下<br>这时，OnPause 方法下的断点命中！OK 达到了调试的目的了</p>
<p>&nbsp;</p>
<p>注册成功后，启动 Windows服务 时遇到错误:1083 的解决办法<br>1.查看 Main() 方法中是否启动了指定的服务<br>ServiceBase[] ServicesToRun;<br>ServicesToRun = new ServiceBase[]<br>{<br>new Service1(),<br>new Service2() //如果建立多个服务需要添加这段代码<br>};<br>ServiceBase.Run(ServicesToRun);</p>
<p>2.确保 ProjectInstaller.cs 视图设计器中的 serviceInstaller1 组件的 ServiceName 属性<br>与 Service1.cs 组件的 ServiceName 属性一致</p>
<hr>
<p>添加服务安装成功后自启动功能</p>
<p>1.打开 ProjectInstaller.cs 视图设计器，选中  serviceInstaller1 组件</p>
<p>2.打开 serviceInstaller1 组件的事件窗口，双击 AfterInstall 事件</p>
<p>3.在 serviceInstaller1_AfterInstall 事件方法下添加如下代码</p>
<p>System.ServiceProcess.ServiceController sc = new System.ServiceProcess.ServiceController();<br>sc.ServiceName = “ExpressDispatchingTrack”; //必须与 ProjectInstaller.cs 视图设计器中的 serviceInstaller1 组件的 ServiceName 属性<br>一致<br>sc.Start();</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>参考<a href="http://blog.csdn.net/xxj_jing/article/details/7542654" target="_blank" rel="external">http://blog.csdn.net/xxj_jing/article/details/7542654</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/windows-Service/">windows Service</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/service/">service</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows-service/">windows service</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Windows Service服务程序开发" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/15/Windows Service服务程序开发/" class="article-date">
      <time datetime="2017-02-15T05:42:20.000Z" itemprop="datePublished">2017-02-15</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/15/Windows Service服务程序开发/">Windows Service服务程序开发</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Windows服务：Microsoft Windows 服务（即，以前的 NT服务）使您能够创建在它们自己的 Windows 会话中可长时间运行的可执行应用程序。这些服务可以在计算机启动时自动启动，可以暂停和重新启动而且不显示任何用户界面。这使服务非常适合在服务器上使用，或任何时候，为了不影响在同一台计算机上工作的其他用户，需要长时间运行功能时使用。还可以在不同于登录用户的特定用户帐户或默认计算机帐户的安全上下文中运行服务。（摘自百度百科）</p>
<p>&nbsp;</p>
<p>一：创建</p>
<p><img src="http://images.cnitblog.com/blog/322940/201401/271153157817965.jpg" alt=""></p>
<p>二：属性</p>
<p>VS自动创建了一个Service1.cs的文件：</p>
<p>点击F4，查看各个属性的含义：</p>
<p><img src="http://images.cnitblog.com/blog/322940/201401/271157011727641.jpg" alt=""></p>
<p>Autolog                 是否自动写入系统的日志文件</p>
<p>CanHandlePowerEvent     服务时候接受电源事件</p>
<p>CanPauseAndContinue          服务是否接受暂停或继续运行的请求</p>
<p>CanShutdown 服务是否在运行它的计算机关闭时收到通知，以便能够调用 OnShutDown 过程</p>
<p>CanStop                              服务是否接受停止运行的请求</p>
<p>ServiceName                       服务名称</p>
<p>三:功能</p>
<p>点击F7查看Service1.cs的源代码：</p>
<p>默认实现了OnStart和OnStop两个方法。</p>
<p>以向一个文本文件中写入数据操作为例：</p>
<p><div class="cnblogs_code"></div></p>
<p><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></p>
<p><pre>   public partial class Service1 : ServiceBase<br>    {<br>        public Service1()<br>        {<br>            InitializeComponent();<br>        }</pre></p>
<pre><code>    /// &amp;lt;summary&amp;gt;
    /// 服务启动
    /// http://www.cnblogs.com/babycool
    /// &amp;lt;/summary&amp;gt;
    /// &amp;lt;param name=&quot;args&quot;&amp;gt;&amp;lt;/param&amp;gt;
    protected override void OnStart(string[] args)
    {
        string start = string.Format(&quot;{0}-{1}&quot;,DateTime.Now.ToString(&quot;yyyyMMddHHmmss&quot;),&quot;程序启动了。&quot;);
        Log(start);
    }

    /// &amp;lt;summary&amp;gt;
    /// 服务停止
    /// http://www.cnblogs.com/babycool
    /// &amp;lt;/summary&amp;gt;
    protected override void OnStop()
    {
        string start = string.Format(&quot;{0}-{1}&quot;, DateTime.Now.ToString(&quot;yyyyMMddHHmmss&quot;), &quot;程序停止了。&quot;);
        Log(start);
    }

    /// &amp;lt;summary&amp;gt;
    /// 系统关闭
    /// http://www.cnblogs.com/babycool
    /// &amp;lt;/summary&amp;gt;
    protected override void OnShutdown()
    {
        string start = string.Format(&quot;{0}-{1}&quot;, DateTime.Now.ToString(&quot;yyyyMMddHHmmss&quot;), &quot;电脑关闭了。&quot;);
        Log(start);
    }

    /*
    /// &amp;lt;summary&amp;gt;
    /// 服务暂停
    /// http://www.cnblogs.com/babycool
    /// &amp;lt;/summary&amp;gt;
    protected override void OnPause()
    {

    }
    */

    /*
    /// &amp;lt;summary&amp;gt;
    /// 服务继续
    /// &amp;lt;/summary&amp;gt;
    protected override void OnContinue()
    {
        base.OnContinue();
    }
    */
    /*
    /// &amp;lt;summary&amp;gt;
    /// 系统电源状态改变
    /// &amp;lt;/summary&amp;gt;
    /// &amp;lt;param name=&quot;powerStatus&quot;&amp;gt;&amp;lt;/param&amp;gt;
    /// &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;
    protected override bool OnPowerEvent(PowerBroadcastStatus powerStatus)
    {
        return base.OnPowerEvent(powerStatus);
    }
    */

    void Log(string str)
    {
        string path = &quot;E://def/6.txt&quot;;
        using (StreamWriter sw = File.AppendText(path))
        {
            sw.WriteLine(str);
        }
    }

}&lt;/pre&gt;
</code></pre><p><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><br><br>四：安装程序</p>
<p>切换到 Service1.cs[设计] 界面，右击选择“添加安装程序”。</p>
<p><img src="http://images.cnitblog.com/blog/322940/201401/271202196093589.jpg" alt=""></p>
<p>这时项目中就添加了一个新类 ProjectInstaller 和两个安装组件 ServiceProcessInstaller 和 ServiceInstaller。</p>
<p>选中“serviceInstaller1” 控件，F4打开属性面板，</p>
<p><img src="http://images.cnitblog.com/blog/322940/201401/271204320473263.jpg" alt=""></p>
<p>Description       服务程序的描述信息</p>
<p>DisplayName     服务程序显示的名称</p>
<p>StartType        指定如何启动服务</p>
<p>Manual      服务安装后，必须手动启动</p>
<p>Automatic    每次计算机重新启动时，服务都会自动启动</p>
<p>Disabled     服务无法启动</p>
<p>&nbsp;</p>
<p>选中“serviceProcessInstaller1” 控件，F4打开属性面板：</p>
<p><img src="http://images.cnitblog.com/blog/322940/201401/271209490005698.jpg" alt=""></p>
<p>&nbsp;</p>
<p>将serviceProcessInstaller类的Account属性改为 LocalSystem。</p>
<p>这样，不论是以哪个用户登录的系统，服务总会启动。</p>
<p>五：生成</p>
<p>右击 项目 选择生成 ，不能通过F5来直接运行服务项目。</p>
<p><img src="http://images.cnitblog.com/blog/322940/201401/271215048449104.jpg" alt=""></p>
<p>&nbsp;</p>
<p>六：安装卸载服务</p>
<p>选择 VS组件 “Visual Studio命令提示(2010)” 工具，并以“管理员身份运行”（win7、win8系统下）。</p>
<p><strong>注意:这里必须选择“以管理员身份运行”，否则会报错。</strong></p>
<p><img src="http://images.cnitblog.com/blog/322940/201401/271252039229498.jpg" alt="">  <img src="http://images.cnitblog.com/blog/322940/201401/271252362811946.jpg" alt=""></p>
<p>从命令行运行 Installutil.exe 目录  命令，以项目中的已编译可执行文件所在的目录作为参数，安装服务：</p>
<p>因为Installutil.exe程序默认在Windows\System32\目录下，需要通过cmd命令 “cd” 切换目录。</p>
<p>从命令行运行 Installutil.exe /u 目录   命令来卸载服务：</p>
<p>安装服务：<br>installutil.exe E:\XTestDemo\X_15_WindowsService\bin\Debug\X_15_WindowsService.exe</p>
<p>卸载服务：<br>installutil.exe /u E:\XTestDemo\X_15_WindowsService\bin\Debug\X_15_WindowsService.exe</p>
<p>七：查看服务状态</p>
<p>在“计算机管理”中，服务 下可以看到刚刚安装的Service服务（cmd命令：services.msc—本地服务设置）：</p>
<p><img src="http://images.cnitblog.com/blog/322940/201401/271259404067673.jpg" alt=""></p>
<p>默认是停止状态。右击，选择“启动”，即可开启服务。</p>
<p><img src="http://images.cnitblog.com/blog/322940/201401/271300337346747.jpg" alt=""></p>
<p>通过“属性”，可以查看到更详细的信息。</p>
<p><img src="http://images.cnitblog.com/blog/322940/201401/271301555478387.jpg" alt=""></p>
<p>&nbsp;</p>
<p>转载请注明出处。</p>
<p>相关参考：</p>
<p><a href="http://www.cnblogs.com/Gsun/archive/2009/12/14/1623995.html" target="_blank" rel="external">用C#创建Windows服务(Windows Services) - Gsun - 博客园</a></p>
<p><a href="http://www.cnblogs.com/yangxi1081/archive/2012/10/22/2733587.html" target="_blank" rel="external">C#开发Windows Services服务–服务安装失败的解决办法 - 无名小虾 - 博客园</a></p>
<p><a href="http://blog.csdn.net/tigerleq/article/details/2417479" target="_blank" rel="external">C#应用服务器！包括（消息服务器，更新服务器，应用服务器）</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/windows-Service/">windows Service</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-thinkphp-timedate" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/01/17/thinkphp-timedate/" class="article-date">
      <time datetime="2017-01-17T08:37:20.000Z" itemprop="datePublished">2017-01-17</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/17/thinkphp-timedate/">thinkphp--time()&amp;&amp;date()</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>time()在PHP中是得到一个数字,这个数字表示从1970-01-01到现在共走了多少秒,很奇怪吧<br>不过这样方便计算,</p>
<p>要找出前一天的时间就是 time()-60<em>60</em>24;<br>要找出前一年的时间就是 time()<em>60</em>60<em>24</em>365</p>
<p>那么如何把这个数字换成日期格式呢,就要用到date函数了</p>
<p>$t=time();<br>echo date(“Y-m-d H:i:s”,$t);   //date(‘w’)</p>
<p>第一个参数的格式分别表示:<br>a - “am” 或是 “pm”<br>A - “AM” 或是 “PM”<br>d - 几日，二位数字，若不足二位则前面补零; 如: “01” 至 “31”<br>D - 星期几，三个英文字母; 如: “Fri”<br>F - 月份，英文全名; 如: “January”<br>h - 12 小时制的小时; 如: “01” 至 “12”<br>H - 24 小时制的小时; 如: “00” 至 “23”<br>g - 12 小时制的小时，不足二位不补零; 如: “1” 至 12”<br>G - 24 小时制的小时，不足二位不补零; 如: “0” 至 “23”<br>i - 分钟; 如: “00” 至 “59”<br>j - 几日，二位数字，若不足二位不补零; 如: “1” 至 “31”<br>l - 星期几，英文全名; 如: “Friday”<br>m - 月份，二位数字，若不足二位则在前面补零; 如: “01” 至 “12”<br>n - 月份，二位数字，若不足二位则不补零; 如: “1” 至 “12”<br>M - 月份，三个英文字母; 如: “Jan”<br>s - 秒; 如: “00” 至 “59”<br>S - 字尾加英文序数，二个英文字母; 如: “th”，”nd”<br>t - 指定月份的天数; 如: “28” 至 “31”<br>U - 总秒数<br>w - 数字型的星期几，如: “0” (星期日) 至 “6” (星期六)<br>Y - 年，四位数字; 如: “1999”<br>y - 年，二位数字; 如: “99”<br>z - 一年中的第几天; 如: “0” 至 “365”<br>其它不在上列的字符则直接列出该字符</p>
<p>&nbsp;</p>
<p>转自 <a href="http://www.thinkphp.cn/topic/9355.html" target="_blank" rel="external">http://www.thinkphp.cn/topic/9355.html</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/ThinkPHP/">ThinkPHP</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/date/">date()</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/thinkphp/">thinkphp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/time/">time()</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-简单的wpf登陆页面" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/12/23/简单的wpf登陆页面/" class="article-date">
      <time datetime="2016-12-23T06:05:54.000Z" itemprop="datePublished">2016-12-23</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/23/简单的wpf登陆页面/">（一）简单的wpf登陆页面</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>本学期末的大作业是实现一个简单的地铁售票系统。自己带着几个组员便根据老师的要求开始做，有组员负责设计简单的页面，然后由我对页面进行简单的美化，并实现前后台逻辑。此系列博客将根据情况逐步更新项目进度。</p>
<p>先看页面效果：</p>
<p><a href="http://www.ihongguang.cn/wp-content/uploads/2016/12/login.png" target="_blank" rel="external"><img class="alignnone size-medium wp-image-202" src="http://www.ihongguang.cn/wp-content/uploads/2016/12/login-300x145.png" alt="wpf_login" width="300" height="145"></a></p>
<p>页面的背景是一张图片，顶端的Login 是一个lable,下方分别是2个textbox,2个button,1个textBlock中嵌套一个hyperlink.</p>
<p>1.当双击双击输入框时，会自动清除框内文字</p>
<p>2.点击Cancel,自动退出项目</p>
<p>3.点击OK,校验并登陆</p>
<p>4.元素居中显示，并自动适应当前屏幕</p>
<p>页面xaml文件代码：</p>
<p><div></div></p>
<p><pre><code>&lt;Window x:Class=”subway.MainWindow”<br>    xmlns=”<a href="http://schemas.microsoft.com/winfx/2006/xaml/presentation" target="_blank" rel="external">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>“<br>    xmlns:x=”<a href="http://schemas.microsoft.com/winfx/2006/xaml" target="_blank" rel="external">http://schemas.microsoft.com/winfx/2006/xaml</a>“<br>    xmlns:d=”<a href="http://schemas.microsoft.com/expression/blend/2008" target="_blank" rel="external">http://schemas.microsoft.com/expression/blend/2008</a>“<br>    xmlns:mc=”<a href="http://schemas.openxmlformats.org/markup-compatibility/2006" target="_blank" rel="external">http://schemas.openxmlformats.org/markup-compatibility/2006</a>“<br>    xmlns:local=”clr-namespace:subway”<br>    mc:Ignorable=”d”<br>    Title=”MainWindow” Margin=”0” Height=”1478.562” Width=”3010.497”  WindowState=”Maximized”&gt;<br>&lt;Window.Background&gt;<br>    &lt;ImageBrush ImageSource=”Image/login_bg.jpg”/&gt;<br>&lt;/Window.Background&gt;<br>&lt;Viewbox&gt;<br>    &lt;Grid  Height=”591” Width=”1022”&gt;<br>        &lt;!–&lt;Grid.Background&gt;<br>            &lt;ImageBrush   ImageSource=”/Image/login_bg.jpg”  /&gt;<br>        &lt;/Grid.Background&gt;–&gt;</code></pre></p>
<pre><code>    &amp;lt;Label x:Name=&quot;label&quot; Content=&quot;Login&quot; Foreground=&quot;White&quot; Margin=&quot;122,43,136,0&quot; VerticalAlignment=&quot;Top&quot; FontFamily=&quot;微软雅黑&quot; FontSize=&quot;45px&quot;  HorizontalContentAlignment=&quot;Center&quot; /&amp;gt;
    &amp;lt;TextBox x:Name=&quot;textBox_username&quot; Margin=&quot;374,163,382,380&quot; TextWrapping=&quot;Wrap&quot; Text=&quot;username&quot;  Opacity=&quot;0.5&quot;  FontFamily=&quot;微软雅黑&quot; FontSize=&quot;25px&quot; /&amp;gt;
    &amp;lt;PasswordBox x:Name=&quot;passwordBox_password&quot; Password=&quot;********&quot; Margin=&quot;374,232,382,314&quot;    Opacity=&quot;0.5&quot; FontFamily=&quot;微软雅黑&quot; FontSize=&quot;25px&quot; ToolTip=&quot;please  input your password&quot;/&amp;gt;
    &amp;lt;Button x:Name=&quot;button&quot; IsDefault=&quot;True&quot; Content=&quot;OK&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;370,335,0,0&quot; VerticalAlignment=&quot;Top&quot; Width=&quot;94&quot; Height=&quot;41&quot; Opacity=&quot;0.7&quot; FontFamily=&quot;微软雅黑&quot; FontSize=&quot;20px&quot; Click=&quot;button_Click&quot; &amp;gt;
        &amp;lt;Button.Template&amp;gt;
            &amp;lt;ControlTemplate TargetType=&quot;{x:Type Button}&quot;&amp;gt;
                &amp;lt;Border BorderBrush=&quot;{TemplateBinding Control.BorderBrush}&quot; BorderThickness=&quot;0&quot; CornerRadius=&quot;8,8,8,8&quot; Name=&quot;PART_Background&quot;&amp;gt;
                    &amp;lt;Border.Background&amp;gt;
                        &amp;lt;LinearGradientBrush EndPoint=&quot;0,1&quot; StartPoint=&quot;0,0&quot;&amp;gt;
                            &amp;lt;GradientStop Color=&quot;White&quot; Offset=&quot;0.0&quot; /&amp;gt;
                            &amp;lt;GradientStop Color=&quot;Silver&quot; Offset=&quot;0.5&quot; /&amp;gt;
                            &amp;lt;GradientStop Color=&quot;White&quot; Offset=&quot;0.0&quot; /&amp;gt;
                        &amp;lt;/LinearGradientBrush&amp;gt;
                    &amp;lt;/Border.Background&amp;gt;
                    &amp;lt;ContentPresenter Content=&quot;{TemplateBinding ContentControl.Content}&quot; HorizontalAlignment=&quot;Center&quot; VerticalAlignment=&quot;Center&quot; /&amp;gt;
                &amp;lt;/Border&amp;gt;
                &amp;lt;ControlTemplate.Triggers&amp;gt;
                    &amp;lt;Trigger Property=&quot;UIElement.IsMouseOver&quot; Value=&quot;True&quot;&amp;gt;
                        &amp;lt;Setter Property=&quot;Border.Background&quot; TargetName=&quot;PART_Background&quot;&amp;gt;
                            &amp;lt;Setter.Value&amp;gt;
                                &amp;lt;LinearGradientBrush EndPoint=&quot;0,1&quot; StartPoint=&quot;0,0&quot;&amp;gt;
                                    &amp;lt;GradientStop Color=&quot;Silver&quot; Offset=&quot;0.0&quot; /&amp;gt;
                                    &amp;lt;GradientStop Color=&quot;White&quot; Offset=&quot;0.5&quot; /&amp;gt;
                                    &amp;lt;GradientStop Color=&quot;Silver&quot; Offset=&quot;0.0&quot; /&amp;gt;
                                &amp;lt;/LinearGradientBrush&amp;gt;
                            &amp;lt;/Setter.Value&amp;gt;
                        &amp;lt;/Setter&amp;gt;
                    &amp;lt;/Trigger&amp;gt;
                    &amp;lt;Trigger Property=&quot;ButtonBase.IsPressed&quot; Value=&quot;True&quot;&amp;gt;
                        &amp;lt;Setter Property=&quot;UIElement.Effect&quot;&amp;gt;
                            &amp;lt;Setter.Value&amp;gt;
                                &amp;lt;DropShadowEffect BlurRadius=&quot;10&quot; Color=&quot;Black&quot; Direction=&quot;0&quot; Opacity=&quot;0.6&quot; RenderingBias=&quot;Performance&quot; ShadowDepth=&quot;0&quot; /&amp;gt;
                            &amp;lt;/Setter.Value&amp;gt;
                        &amp;lt;/Setter&amp;gt;
                    &amp;lt;/Trigger&amp;gt;
                &amp;lt;/ControlTemplate.Triggers&amp;gt;
            &amp;lt;/ControlTemplate&amp;gt;
        &amp;lt;/Button.Template&amp;gt;
    &amp;lt;/Button&amp;gt;
    &amp;lt;Button x:Name=&quot;button1&quot; IsCancel=&quot;True&quot; Content=&quot;Cancel&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;546,335,0,0&quot; VerticalAlignment=&quot;Top&quot; Width=&quot;94&quot; Height=&quot;41&quot; Opacity=&quot;0.7&quot; FontFamily=&quot;微软雅黑&quot; FontSize=&quot;20px&quot; Click=&quot;button1_Click&quot; RenderTransformOrigin=&quot;0.553,1.355&quot; &amp;gt;
        &amp;lt;Button.Template&amp;gt;
            &amp;lt;ControlTemplate TargetType=&quot;{x:Type Button}&quot;&amp;gt;
                &amp;lt;Border BorderBrush=&quot;{TemplateBinding Control.BorderBrush}&quot; BorderThickness=&quot;0&quot; CornerRadius=&quot;8,8,8,8&quot; Name=&quot;PART_Background&quot;&amp;gt;
                    &amp;lt;Border.Background&amp;gt;
                        &amp;lt;LinearGradientBrush EndPoint=&quot;0,1&quot; StartPoint=&quot;0,0&quot;&amp;gt;
                            &amp;lt;GradientStop Color=&quot;White&quot; Offset=&quot;0.0&quot; /&amp;gt;
                            &amp;lt;GradientStop Color=&quot;Silver&quot; Offset=&quot;0.5&quot; /&amp;gt;
                            &amp;lt;GradientStop Color=&quot;White&quot; Offset=&quot;0.0&quot; /&amp;gt;
                        &amp;lt;/LinearGradientBrush&amp;gt;
                    &amp;lt;/Border.Background&amp;gt;
                    &amp;lt;ContentPresenter Content=&quot;{TemplateBinding ContentControl.Content}&quot; HorizontalAlignment=&quot;Center&quot; VerticalAlignment=&quot;Center&quot; /&amp;gt;
                &amp;lt;/Border&amp;gt;
                &amp;lt;ControlTemplate.Triggers&amp;gt;
                    &amp;lt;Trigger Property=&quot;UIElement.IsMouseOver&quot; Value=&quot;True&quot;&amp;gt;
                        &amp;lt;Setter Property=&quot;Border.Background&quot; TargetName=&quot;PART_Background&quot;&amp;gt;
                            &amp;lt;Setter.Value&amp;gt;
                                &amp;lt;LinearGradientBrush EndPoint=&quot;0,1&quot; StartPoint=&quot;0,0&quot;&amp;gt;
                                    &amp;lt;GradientStop Color=&quot;Silver&quot; Offset=&quot;0.0&quot; /&amp;gt;
                                    &amp;lt;GradientStop Color=&quot;White&quot; Offset=&quot;0.5&quot; /&amp;gt;
                                    &amp;lt;GradientStop Color=&quot;Silver&quot; Offset=&quot;0.0&quot; /&amp;gt;
                                &amp;lt;/LinearGradientBrush&amp;gt;
                            &amp;lt;/Setter.Value&amp;gt;
                        &amp;lt;/Setter&amp;gt;
                    &amp;lt;/Trigger&amp;gt;
                    &amp;lt;Trigger Property=&quot;ButtonBase.IsPressed&quot; Value=&quot;True&quot;&amp;gt;
                        &amp;lt;Setter Property=&quot;UIElement.Effect&quot;&amp;gt;
                            &amp;lt;Setter.Value&amp;gt;
                                &amp;lt;DropShadowEffect BlurRadius=&quot;10&quot; Color=&quot;Black&quot; Direction=&quot;0&quot; Opacity=&quot;0.6&quot; RenderingBias=&quot;Performance&quot; ShadowDepth=&quot;0&quot; /&amp;gt;
                            &amp;lt;/Setter.Value&amp;gt;
                        &amp;lt;/Setter&amp;gt;
                    &amp;lt;/Trigger&amp;gt;
                &amp;lt;/ControlTemplate.Triggers&amp;gt;
            &amp;lt;/ControlTemplate&amp;gt;
        &amp;lt;/Button.Template&amp;gt;
    &amp;lt;/Button&amp;gt;
    &amp;lt;TextBlock  HorizontalAlignment=&quot;Left&quot; Margin=&quot;576,282,0,0&quot; VerticalAlignment=&quot;Top&quot; Foreground=&quot;#216380&quot;&amp;gt;
    &amp;lt;Hyperlink NavigateUri=&quot;../Admin/Admin_getPassword&quot; Click=&quot;Hyperlink_getPWD_Click&quot; &amp;gt;找回密码. . . &amp;lt;/Hyperlink&amp;gt;
    &amp;lt;/TextBlock&amp;gt;
&amp;lt;/Grid&amp;gt;
</code></pre><p>&lt;/Viewbox&gt;</p>
<p><br><br><strong>后台逻辑代码：</strong></p>
<p>在构造函数中设置自动适应当前屏幕</p>
<p><pre><code>       double x = SystemParameters.WorkArea.Width;//得到屏幕工作区域宽度<br>        double y = SystemParameters.WorkArea.Height;//得到屏幕工作区域高度<br>        double x1 = SystemParameters.PrimaryScreenWidth;//得到屏幕整体宽度<br>        double y1 = SystemParameters.PrimaryScreenHeight;//得到屏幕整体高度<br>        this.Width = x1;//设置窗体宽度<br>        this.Height = y1;//设置窗体高度<br>        this.Title = “登陆”;</code></pre><br>&nbsp;</p>
<p>双击输入框</p>
<p><div></div></p>
<p><pre><code>    textBox_username.MouseDoubleClick += BoxMouseDoubleClick;<br>    passwordBox_password.MouseDoubleClick += BoxMouseDoubleClick;<br>    private void BoxMouseDoubleClick(object sender, MouseButtonEventArgs e)<br>    {<br>        passwordBox_password.Password = “”;<br>        textBox_username.Text = “”;<br>    }</code></pre><br><br>&nbsp;</p>
<p>点击Cancel</p>
<p><div></div></p>
<p><pre><code>this.Close();</code></pre><br><br>点击OK</p>
<p><pre><code>   /// &lt;summary&gt;<br>    /// 点击OK 实现登陆<br>    /// &lt;/summary&gt;<br>    /// &lt;param name=”sender”&gt;&lt;/param&gt;<br>    /// &lt;param name=”e”&gt;&lt;/param&gt;<br>    private void button_Click(object sender, RoutedEventArgs e)<br>    {<br>        BaseFunc baseFc = new BaseFunc();<br>        username = textBox_username.Text.Trim();</code></pre></p>
<pre><code>    string password = passwordBox_password.Password.Trim();
    if(username==&quot;&quot;||password==&quot;&quot;)
    {
        MessageBox.Show(&quot;请输入正确信息&quot;);
        return;
    }
    else
    {
        bool isLogin = baseFc.GetLoginCheck(username, password);
        if(isLogin)
        {
            //this.Close();
            // MessageBox.Show(&quot;登陆成功&quot;);
            chooseSystem chose = new chooseSystem();
            chose.ShowDialog();
        }
        else
        {
            MessageBox.Show(&quot;登陆失败，无此用户或信息错误&quot;);
        }
    }
    MessageBox.Show(username);

}&lt;/code&gt;&lt;/pre&gt;
</code></pre><p>找回密码的页面与的登陆相同，后台逻辑在之前的博客中已经写过，邮件不会当作垃圾邮件处理，目前不支持域邮箱。再次贴出代码（包括用户检测，邮件发送）</p>
<p><div></div></p>
<p><pre><code>    #region 密码丢失</code></pre></p>
<pre><code>/// &amp;lt;summary&amp;gt;
/// 发送密码
/// &amp;lt;/summary&amp;gt;
/// &amp;lt;param name=&quot;username&quot;&amp;gt;用户名&amp;lt;/param&amp;gt;
/// &amp;lt;param name=&quot;password&quot;&amp;gt;新密码&amp;lt;/param&amp;gt;
/// &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;
public string GetSendpasswrord(string username, string email)
{
    User member = new User();
    if (baseF.GetCheckUser(username))//检查是否已被注册
    {
        try
        {
            SqlConnection conn = connectdb.ConnectDataBase();
            //打开数据库
            conn.Open();
            //创建查询语句
            SqlCommand querySingleInfo = conn.CreateCommand();
                querySingleInfo.CommandText = &quot;SELECT email FROM coustom where UserName=&quot; + &quot;&apos;&quot; + username + &quot;&apos;&quot;;
            SqlDataReader singleInfoReader = querySingleInfo.ExecuteReader();
            //有多行数据，用while循环
            while (singleInfoReader.Read())
            {
                member.email = singleInfoReader[&quot;email&quot;].ToString().Trim();
            }
            if (member.email.Equals(email))
            {
                string pwd = &quot;你的密码是: &quot;;
                //获取密码
                pwd += Getpassrord(username);
                pwd += &quot; , 请妥善保存&quot;;
                //发送邮件
                checkInfo = SendEmail(email, pwd);
            }
            else
            {
                checkInfo = &quot;邮箱错误&quot;;
            }
        }
        catch (SqlException e)
        {
            Console.WriteLine(&quot;查询错误&quot;);
            checkInfo = &quot;查询错误&quot;;
        }
    }
    else
        checkInfo = &quot;用户名不存在&quot;;
    return checkInfo;
}

/// &amp;lt;summary&amp;gt;
/// 获取用户密码
/// &amp;lt;/summary&amp;gt;
/// &amp;lt;param name=&quot;username&quot;&amp;gt;用户名&amp;lt;/param&amp;gt;
/// &amp;lt;returns&amp;gt;返回查询结果&amp;lt;/returns&amp;gt;
private string Getpassrord(string username)
{
    string password = &quot;&quot;;
    try
    {
        SqlConnection conn = connectdb.ConnectDataBase();
        //打开数据库
        conn.Open();
        //创建查询语句
        SqlCommand querySingleInfo = conn.CreateCommand();
            querySingleInfo.CommandText = &quot;SELECT Password FROM coustom where UserName=&quot; + &quot;&apos;&quot; + username + &quot;&apos;&quot;;
        SqlDataReader singleInfoReader = querySingleInfo.ExecuteReader();
        //有多行数据，用while循环
        while (singleInfoReader.Read())
        {
            password = singleInfoReader[&quot;Password&quot;].ToString().Trim();
        }
        //关闭查询
        singleInfoReader.Close();
        //关闭数据库连接
        conn.Close();
    }
    catch (SqlException e)
    {
        password = &quot;查询失败&quot;;
    }
    return password;
}

/// &amp;lt;summary&amp;gt;
/// 发送邮件
/// &amp;lt;/summary&amp;gt;
/// &amp;lt;param name=&quot;email&quot;&amp;gt;邮件&amp;lt;/param&amp;gt;
/// &amp;lt;param name=&quot;password&quot;&amp;gt;授权码&amp;lt;/param&amp;gt;
/// &amp;lt;returns&amp;gt;&amp;lt;/returns&amp;gt;
private string SendEmail(string email, string message)
{
    try
    {
        SmtpClient smtpClient = new SmtpClient();
        smtpClient.EnableSsl = true;
        smtpClient.UseDefaultCredentials = true;
        smtpClient.DeliveryMethod = SmtpDeliveryMethod.Network;//指定电子邮件发送方式        
        smtpClient.Host = &quot;smtp.qq.com&quot;;//指定SMTP服务器  (126)    
        System.Net.NetworkCredential nc = new System.Net.NetworkCredential(&quot;a@qq.com&quot;, &quot;授权码&quot;);
        smtpClient.Credentials = nc;//用户名和授权码
        // 发送邮件设置        
        MailMessage mailMessage = new MailMessage(&quot;a@qq.com&quot;, email); // 发送人和收件人        
        mailMessage.Subject = &quot;密码找回&quot;;//主题        
        mailMessage.Body = message;
        mailMessage.BodyEncoding = Encoding.UTF8;//正文编码        
        mailMessage.IsBodyHtml = true;//设置为HTML格式        
        mailMessage.Priority = MailPriority.High;//优先级
        smtpClient.Send(mailMessage);
        sendInfo = &quot;发送成功&quot;;
    }
    catch (Exception e)
    {
        sendInfo = e.ToString();
    }
    return sendInfo;
}

#endregion&lt;/code&gt;&lt;/pre&gt;
</code></pre><p><br>&nbsp;</p>
<p>&nbsp;</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/wpf/">wpf</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NET/">.NET</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wpf/">wpf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/登陆页面/">登陆页面</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-slack关联gitlb" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/11/01/slack关联gitlb/" class="article-date">
      <time datetime="2016-11-01T15:54:32.000Z" itemprop="datePublished">2016-11-01</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/01/slack关联gitlb/">slack关联gitlb</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>slack作为目前团队交流的头号先锋，在我们的项目协调中发挥着很大的作用。其中一项就是实时推送gitlab中的各种动态，此时就需要搭建一个桥梁用来连接，使之实现通讯</p>
<p>&nbsp;</p>
<h1 id="Slack-Service"><a href="#Slack-Service" class="headerlink" title="Slack Service"></a>Slack Service</h1><h2 id="On-Slack"><a href="#On-Slack" class="headerlink" title="On Slack"></a>On Slack</h2><p>To enable Slack integration you must create an incoming webhook integration on Slack:</p>
<ol>
<li><a href="https://slack.com/signin" target="_blank" rel="external">Sign in to Slack</a></li>
<li>Visit <a href="https://my.slack.com/services/new/incoming-webhook/" target="_blank" rel="external">Incoming WebHooks</a></li>
<li>Choose the channel name you want to send notifications to.</li>
<li>Click <strong>Add Incoming WebHooks Integration</strong></li>
<li>Copy the <strong>Webhook URL</strong>, we’ll need this later for GitLab.</li>
</ol>
<h2 id="On-GitLab"><a href="#On-GitLab" class="headerlink" title="On GitLab"></a>On GitLab</h2><p>After you set up Slack, it’s time to set up GitLab.</p>
<p>Go to your project’s <strong>Settings &gt; Services &gt; Slack</strong> and you will see a checkbox with the following events that can be triggered:</p>
<ul>
<li>Push</li>
<li>Issue</li>
<li>Merge request</li>
<li>Note</li>
<li>Tag push</li>
<li>Build</li>
<li>Wiki page<br>Bellow each of these event checkboxes, you will have an input field to insert which Slack channel you want to send that event message, with <code>#general</code> being the default. Enter your preferred channel <strong>without</strong> the hash sign (<code>#</code>).</li>
</ul>
<p>At the end, fill in your Slack details:</p>
<p><table></table></p>
<p><thead></thead></p>
<p><tr class="header"></tr></p>
<p><th align="left">Field</th></p>
<p><th align="left">Description</th><br><br></p>
<p><tbody></tbody></p>
<p><tr class="odd"></tr></p>
<p><td align="left"><strong>Webhook</strong></td></p>
<p><td align="left">The <a href="https://my.slack.com/services/new/incoming-webhook" target="_blank" rel="external">incoming webhook URL</a> which you have to setup on Slack.</td><br></p>
<p><tr class="even"></tr></p>
<p><td align="left"><strong>Username</strong></td></p>
<p><td align="left">Optional username which can be on messages sent to slack. Fill this in if you want to change the username of the bot.</td><br></p>
<p><tr class="odd"></tr></p>
<p><td align="left"><strong>Notify only broken builds</strong></td></p>
<p><td align="left">If you choose to enable the <strong>Build</strong> event and you want to be only notified about failed builds.</td><br><br><br><br>After you are all done, click <strong>Save changes</strong> for the changes to take effect.</p>
<blockquote>
<p><strong>Note:</strong> You can set “branch,pushed,Compare changes” as highlight words on your Slack profile settings, so that you can be aware of new commits when somebody pushes them.<br><img src="https://docs.gitlab.com/ee/project_services/img/slack_configuration.png" alt="Slack configuration"></p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/未分类/">未分类</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-ThinkPHP实现数据增删改查" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/10/28/ThinkPHP实现数据增删改查/" class="article-date">
      <time datetime="2016-10-28T12:28:34.000Z" itemprop="datePublished">2016-10-28</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/28/ThinkPHP实现数据增删改查/">ThinkPHP实现数据增删改查</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <div class="detail-content ">

<p>提到ThinkPHP，相信大家都有听说，相信很多朋友也都已经会使用，今天还是想写一下关于ThinkPHP的一些基本使用方法，希望对还不会使用的朋友能提供一些帮助！</p>
<p>一、下载ThinkPHP源码包，登录ThinkPHP的官方网站：<a href="http://www.thinkphp.cn%EF%BC%8C%E5%9C%A8%E5%8F%B3%E4%BE%A7%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0ThinkPHP%E6%BA%90%E7%A0%81%E5%8C%85%E7%9A%84%E4%B8%8B%E8%BD%BD%EF%BC%8C%E6%88%91%E4%BB%AC%E8%BF%99%E9%87%8C%E4%BB%A53.2.3%E8%BF%99%E4%B8%AA%E7%89%88%E6%9C%AC%E8%BF%9B%E8%A1%8C%E8%AE%B2%E8%A7%A3/" target="_blank" rel="nofollow noopener">http://www.thinkphp.cn，在右侧可以看到ThinkPHP源码包的下载，我们这里以3.2.3这个版本进行讲解</a>。<br><img title="ThinkPHP实现数据增删改查_" src="http://img.mukewang.com/5716f6560001162902690205.png" alt="图片描述"><br>二、将下载后得到的包复制到你的服务器运行目录下，如果你使用的是Wamp等一些PHP服务器套件，一般就是需要将其复制到WWW目录下。<br><img title="ThinkPHP实现数据增删改查_" src="http://img.mukewang.com/5716f6dd000161b604220155.png" alt="图片描述"><br>三、这时候在浏览器输入你服务器的访问地址即可成功运行ThinkPHP，例如：<a href="http://localhost/thinkphp%EF%BC%8C%E8%BF%90%E8%A1%8C%E6%88%90%E5%8A%9F%E5%90%8E%EF%BC%8C%E4%BC%9A%E5%BE%97%E5%88%B0%E5%A6%82%E4%B8%8B%E9%A1%B5%E9%9D%A2" target="_blank" rel="nofollow noopener">http://localhost/thinkphp，运行成功后，会得到如下页面</a>：<br><img title="ThinkPHP实现数据增删改查_" src="http://img.mukewang.com/5716f6f20001068305690348.jpg" alt="图片描述"><br>至此，恭喜你已成功安装ThinkPHP。<br>下面说下最基本的“增删改查”四步操作！<br>在使用ThinkPHP之前，我们先来了解一下什么是MVC设计模式，MVC即模型-视图-控制器（Model-View-Controller）的简称，我们举个例子，通过这个例子大家也许可以更好的理解MVC。<br>我们现在想象一个场景，我们在公司上班，我们都会有一个老板，这个老板我们就想象为是控制器，他发话让你去干什么事情，也就是他控制你去干什么事情，具体这件事怎么干他不管，你就可以按照你的方法去做，你做这件事的这个方法就是模型，当你做完这件事后，你把这个事情的结果即视图返回给老板，老板将视图上显示的内容返回给客户。就这么一个过程。下面我们开始数据的增删改查。<br>一、连接数据库<br>1、增加数据，当然需要用到数据库，所以我们先建立一个数据库名为thinkphp，然后在这个库里面新建一张数据表think<em>users，至于为什么前面要加上think</em>，我们待会说，在这张表里面添加3个字段，user_id,user_name,user_password,user<em>score。<br>&lt;img title=”ThinkPHP实现数据增删改查</em>“ src=”<a href="http://img.mukewang.com/57172a020001de9301650119.png" target="_blank" rel="external">http://img.mukewang.com/57172a020001de9301650119.png</a>“ alt=”图片描述” /&gt;<br>2、现在需要在Conf文件夹下的Config.php中加入相关数据库配置代码，这里可以看到数据库表前缀，也就是我们之前为什么要在表名前加think_的原因<br>//数据库配置信息<br>‘DB_TYPE’ =&gt; ‘mysql’, // 数据库类型<br>‘DB_HOST’ =&gt; ‘127.0.0.1’, // 服务器地址<br>‘DB_NAME’ =&gt; ‘thinkphp’, // 数据库名<br>‘DB_USER’ =&gt; ‘root’, // 用户名<br>‘DB_PWD’ =&gt; ‘123456’, // 密码<br>‘DB_PORT’ =&gt; 3306, // 端口<br>‘DB_PARAMS’ =&gt; array(), // 数据库连接参数<br>‘DB<em>PREFIX’ =&gt; ‘think</em>‘, // 数据库表前缀<br>‘DB_CHARSET’=&gt; ‘utf8’, // 字符集<br>‘DB<em>DEBUG’ =&gt; TRUE, // 数据库调试模式 开启后可以记录SQL日志<br>3、现在验证下数据库有没有联通，我们在数据库中插入一些数据，如下：<br>&lt;img title=”ThinkPHP实现数据增删改查</em>“ src=”<a href="http://img.mukewang.com/57172a1d0001ea3606830150.png" target="_blank" rel="external">http://img.mukewang.com/57172a1d0001ea3606830150.png</a>“ alt=”图片描述” /&gt;<br>现在在Controller文件夹下的IndexController.class.php中加入如下代码：<img title="ThinkPHP实现数据增删改查_" src="http://img.mukewang.com/57172a3a0001651504190179.png" alt="图片描述"><br>此时运行浏览器，如果出现下面的数据显示，表示数据库已经成功连接，如果出现错误提示，请检查一下数据库端口或密码是否配置正确。<img title="ThinkPHP实现数据增删改查_" src="http://img.mukewang.com/57172a500001340207140560.png" alt="图片描述"><br>好了，看到这个说明你已经成功连接数据库，并且把数据已经读出来了。<br>二、增加数据<br>数据库连接好了之后，我们下一步就是对数据进行添加了。<br>依旧在刚刚的IndexController.class.php中继续添加代码：<img title="ThinkPHP实现数据增删改查_" src="http://img.mukewang.com/57172a730001676804150113.png" alt="图片描述"><br>现在在浏览器输入地址访问这个addData控制器：<a href="http://localhost:8888/thinkphp/home/index/adddata%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%9C%B0%E5%9D%80%E5%89%8D%E9%9D%A2%E7%9A%84%E5%9F%9F%E5%90%8D%E6%A0%B9%E6%8D%AE%E4%BD%A0%E7%9A%84%E5%AE%9E%E9%99%85%E6%83%85%E5%86%B5%E8%BF%9B%E8%A1%8C%E4%BF%AE%E6%94%B9%EF%BC%8C%E8%BF%99%E6%97%B6%E5%80%99%EF%BC%8C%E9%A1%B5%E9%9D%A2%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E6%8A%A5%E9%94%99%EF%BC%8C%E7%A9%BA%E7%99%BD%E6%98%BE%E7%A4%BA%E5%B0%B1%E8%AF%81%E6%98%8E%E5%B7%B2%E7%BB%8F%E6%88%90%E5%8A%9F%E6%89%A7%E8%A1%8C%E4%BA%86%E3%80%82%E7%8E%B0%E5%9C%A8%E5%9B%9E%E5%88%B0%E5%88%9A%E5%88%9A%E7%9A%84%E6%95%B0%E6%8D%AE%E8%A1%A8%EF%BC%8C%E5%88%B7%E6%96%B0%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E5%88%9A%E5%88%9A%E6%B7%BB%E5%8A%A0%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%AF%86%E7%A0%81%E8%BF%99%E9%87%8C%E8%BF%9B%E8%A1%8C%E4%BA%86MD5%E5%8A%A0%E5%AF%86%E3%80%82![%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0][9" target="_blank" rel="nofollow noopener">http://localhost:8888/thinkphp/home/index/adddata，这个地址前面的域名根据你的实际情况进行修改，这时候，页面如果没有报错，空白显示就证明已经成功执行了。现在回到刚刚的数据表，刷新就可以看到刚刚添加的数据，密码这里进行了MD5加密。![图片描述][9</a>]<br>三、查询数据<br>其实我们之前已经讲过了，$Users-&gt;select();就可以读出表中的所有数据，只是如果我们需要针对相关条件进行筛选这里要怎么做呢，比如我们现在看一下数据表中完整的数据如下：<img title="ThinkPHP实现数据增删改查_" src="http://img.mukewang.com/57172a950001ac7b06760172.png" alt="图片描述"><br>现在我们需要读取用户分数大于90分的用户，可以这样写：<img title="ThinkPHP实现数据增删改查_" src="http://img.mukewang.com/57172ab40001795e03810069.png" alt="图片描述"><br>在上面的数据表我们可以看到共有三个用户的分数大于90分，所以执行这段查询代码已经就只会得到三个用户的数据，我们现在运行：<a href="http://localhost:8888/thinkphp/home/index/selectscore%EF%BC%8C%E5%BE%97%E5%88%B0%E4%B8%8B%E5%9B%BE%EF%BC%9A![%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0][12" target="_blank" rel="nofollow noopener">http://localhost:8888/thinkphp/home/index/selectscore，得到下图：![图片描述][12</a>]<br>发现确实只有id为3、4、5的三位用户的数据被查询了出来。<br>四、修改数据<br>那么如何修改数据呢，可以这样写：<img title="ThinkPHP实现数据增删改查_" src="http://img.mukewang.com/57172ada00013f9b04210132.png" alt="图片描述"><br>这时候运行浏览器输入地址<a href="http://localhost:8888/thinkphp/home/index/updatedata，就可以看到user_id为6的用户的数据被修改了。" target="_blank" rel="external">http://localhost:8888/thinkphp/home/index/updatedata，就可以看到user_id为6的用户的数据被修改了。</a><img title="ThinkPHP实现数据增删改查_" src="http://img.mukewang.com/57172b0f0001654806800023.png" alt="图片描述"><br>五、删除数据<br>删除也很简单，只需将代码换为：<br>$Users = M(“Users”); // 实例化Usesr对象<br>$Users-&gt;where(‘user_id=5’)-&gt;delete(); // 删除user_id为5的用户数据<br>这样一运行就可以删除user_id为5的数据了。</p>
<p></p></div><p></p>
<p></p><p class="original">本文原创发布于慕课网 ，转载请注明出处，谢谢合作！</p><br>作者： 当代码遇上音乐<br>链接：<a href="http://www.imooc.com/article/6747?block_id=tuijian_wz" target="_blank" rel="external">http://www.imooc.com/article/6747?block_id=tuijian_wz</a><br>来源：慕课网<br>本文原创发布于慕课网 ，转载请注明出处，谢谢合作！<p></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/ThinkPHP/">ThinkPHP</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CURD/">CURD</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/thinkphp/">thinkphp</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2017 谢红光
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 6;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>